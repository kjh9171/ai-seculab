<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Seculab | Advanced Security Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff;
            color: #334155;
            margin: 0;
            transition: all 0.5s ease;
        }

        * {
            font-weight: 300 !important;
        }

        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .dark-theme {
            background-color: #0f172a;
            color: #f1f5f9;
        }

        .dark-theme .glass {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        canvas#hero-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.4;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        // --- 메인 애플리케이션 ---
        const App = () => {
            const [view, setView] = React.useState('home');
            const [isDark, setIsDark] = React.useState(false);
            const [setupStatus, setSetupStatus] = React.useState({ setupDone: false });
            const [qrCode, setQrCode] = React.useState('');
            const [isAdminAuth, setIsAdminAuth] = React.useState(false);
            const [inquiries, setInquiries] = React.useState([]);
            const [formData, setFormData] = React.useState({ name: '', email: '', message: '' });

            React.useEffect(() => {
                const checkStatus = async () => {
                    const res = await fetch('/api/admin/status');
                    const data = await res.json();
                    setSetupStatus(data);
                };
                checkStatus();
            }, []);

            React.useEffect(() => {
                if (isDark) document.body.classList.add('dark-theme');
                else document.body.classList.remove('dark-theme');
            }, [isDark]);

            // 문의하기 제출
            const handleInquirySubmit = async (e) => {
                e.preventDefault();
                const res = await fetch('/api/inquiries', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });
                if (res.ok) {
                    alert('문의사항이 보안 서버에 안전하게 기록되었습니다.');
                    setFormData({ name: '', email: '', message: '' });
                }
            };

            // OTP 로그인 및 셋업
            const handleAdminEntry = async () => {
                if (view === 'admin') { setView('home'); return; }

                if (!setupStatus.setupDone) {
                    // 최초 셋업: QR코드 요청
                    const res = await fetch('/api/admin/setup');
                    const data = await res.json();
                    setQrCode(data.qr);
                    setView('setup');
                } else {
                    // 로그인 시도
                    const token = prompt('Google OTP(6자리)를 입력하십시오:');
                    if (!token) return;
                    const res = await fetch('/api/admin/login', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ token })
                    });
                    if (res.ok) {
                        setIsAdminAuth(true);
                        setView('admin');
                        fetchInquiries();
                    } else {
                        alert('인증 코드가 일치하지 않습니다.');
                    }
                }
            };

            const confirmSetup = async (token) => {
                const res = await fetch('/api/admin/setup-confirm', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ token })
                });
                if (res.ok) {
                    alert('보안 인증 설정이 완료되었습니다.');
                    setSetupStatus({ setupDone: true });
                    setView('home');
                } else {
                    alert('잘못된 코드입니다.');
                }
            };

            const fetchInquiries = async () => {
                const res = await fetch('/api/admin/inquiries');
                const data = await res.json();
                setInquiries(data);
            };

            const updateInquiryStatus = async (id, currentStatus) => {
                const status = currentStatus === 'completed' ? 'pending' : 'completed';
                await fetch('/api/admin/inquiries/update', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id, status })
                });
                fetchInquiries();
            };

            // 히어로 캔버스
            React.useEffect(() => {
                const canvas = document.getElementById('hero-canvas');
                if (!canvas) return;
                const ctx = canvas.getContext('2d');
                let pts = [];
                const init = () => {
                    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
                    pts = Array.from({ length: 40 }, () => ({
                        x: Math.random() * canvas.width, y: Math.random() * canvas.height,
                        vx: (Math.random() - 0.5) * 0.5, vy: (Math.random() - 0.5) * 0.5
                    }));
                };
                const anim = () => {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.strokeStyle = isDark ? 'rgba(99,102,241,0.2)' : 'rgba(148,163,184,0.4)';
                    pts.forEach((p, i) => {
                        p.x += p.vx; p.y += p.vy;
                        if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
                        if (p.y < 0 || p.y > canvas.height) p.vy *= -1;
                        for (let j = i + 1; j < pts.length; j++) {
                            const d = Math.sqrt((p.x - pts[j].x) ** 2 + (p.y - pts[j].y) ** 2);
                            if (d < 150) {
                                ctx.beginPath(); ctx.moveTo(p.x, p.y); ctx.lineTo(pts[j].x, pts[j].y); ctx.stroke();
                            }
                        }
                    });
                    requestAnimationFrame(anim);
                };
                init(); anim();

                // 서비스 상세 차트 초기화 (취약점 탐지 데모)
                const vulnCtx = document.getElementById('chart-vuln')?.getContext('2d');
                let vulnChart;
                if (vulnCtx) {
                    vulnChart = new Chart(vulnCtx, {
                        type: 'line',
                        data: {
                            labels: ['12:00', '13:00', '14:00', '15:00', '16:00'],
                            datasets: [{
                                data: [12, 19, 15, 25, 22],
                                borderColor: isDark ? '#6366f1' : '#1e293b',
                                borderWidth: 1,
                                pointRadius: 0,
                                fill: false,
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: { y: { display: false }, x: { display: false } }
                        }
                    });
                }

                window.addEventListener('resize', init);
                return () => {
                    window.removeEventListener('resize', init);
                    if (vulnChart) vulnChart.destroy();
                };
            }, [isDark, view]);

            return (
                <div className="min-h-screen flex flex-col">
                    <header className="fixed top-0 w-full z-50 glass border-b border-black/5 dark:border-white/5">
                        <div className="max-w-7xl mx-auto px-8 h-20 flex items-center justify-between">
                            <h1 className="text-2xl tracking-tighter" onClick={() => setView('home')}>
                                AI <span className="text-indigo-500">Seculab</span>
                            </h1>
                            <nav className="flex gap-10 text-[11px] uppercase tracking-widest text-slate-500 items-center">
                                <button onClick={() => setView('home')} className="hover:text-indigo-400 transition-all">Home</button>
                                <a href="https://www.youtube.com/@SecurityReport-K" target="_blank" rel="noopener noreferrer" className="text-red-500 hover:text-red-400 font-normal transition-all">YouTube</a>
                                <button onClick={handleAdminEntry} className="text-indigo-500 font-normal">
                                    {view === 'admin' ? 'Logout' : 'Admin'}
                                </button>
                                <button onClick={() => setIsDark(!isDark)} className="text-slate-400">
                                    {isDark ? 'Light' : 'Dark'}
                                </button>
                            </nav>
                        </div>
                    </header>

                    {view === 'home' && (
                        <main className="flex-grow pt-20">
                            {/* Hero Section */}
                            <section id="hero" className="relative h-[90vh] flex items-center justify-center overflow-hidden">
                                <canvas id="hero-canvas"></canvas>
                                <div className="relative z-10 text-center px-4 max-w-4xl">
                                    <span className="text-[10px] tracking-[0.6em] text-indigo-500 uppercase mb-10 block animate-pulse">Next-Gen Intelligence Architecture</span>
                                    <h2 className="text-5xl md:text-8xl mb-12 leading-[1.1] font-normal tracking-tighter">
                                        보안의 지능화,<br />
                                        <span className="text-slate-400">그 이상의 가치.</span>
                                    </h2>
                                    <p className="text-xl text-slate-400 mb-16 leading-relaxed max-w-2xl mx-auto">
                                        AI Seculab은 독보적인 분석 기술과 폐쇄형 아키텍처를 통해<br />
                                        가장 안전한 비즈니스 인텔리전스를 설계합니다.
                                    </p>
                                    <div className="flex justify-center gap-8">
                                        <a href="#expertise" className="px-12 py-5 bg-slate-900 text-white dark:bg-indigo-600 text-[10px] tracking-[0.3em] uppercase hover:scale-105 transition-all">Explore Expertise</a>
                                        <a href="#contact" className="px-12 py-5 border border-slate-200 dark:border-white/10 text-[10px] tracking-[0.3em] uppercase hover:bg-slate-50 dark:hover:bg-white/5 transition-all">Contact Us</a>
                                    </div>
                                </div>
                            </section>

                            {/* Vision Section */}
                            <section id="vision" className="py-40 bg-white dark:bg-slate-950 border-y border-black/5 dark:border-white/5">
                                <div className="max-w-7xl mx-auto px-8 grid grid-cols-1 md:grid-cols-2 gap-20 items-center">
                                    <div>
                                        <span className="text-[9px] tracking-[0.4em] text-indigo-500 uppercase mb-6 block">Our Philosophy</span>
                                        <h3 className="text-4xl mb-10 leading-snug font-normal">비전: 통제 가능한 지능형 보안</h3>
                                        <p className="text-slate-500 leading-loose text-lg">
                                            우리는 클라우드에 의존하지 않는 독립적인 보안 인텔리전스를 지향합니다.
                                            데이터가 외부로 유출되지 않는 환경에서 AI의 강력한 탐지 성능을 100% 활용하는 것,
                                            것이 AI Seculab이 정의하는 '통제 가능한 보안'의 시작입니다.
                                        </p>
                                    </div>
                                    <div className="glass p-12 aspect-video flex flex-col justify-center">
                                        <div className="flex justify-between items-end mb-8">
                                            <div className="text-xs tracking-widest text-slate-400">SECURE DATA FLOW</div>
                                            <div className="text-3xl text-indigo-500">99.9%</div>
                                        </div>
                                        <div className="space-y-4">
                                            <div className="h-1 bg-slate-100 dark:bg-slate-800 w-full rounded-full overflow-hidden">
                                                <div className="h-full bg-indigo-500 w-[95%]"></div>
                                            </div>
                                            <div className="h-1 bg-slate-100 dark:bg-slate-800 w-full rounded-full overflow-hidden">
                                                <div className="h-full bg-slate-400 w-[80%]"></div>
                                            </div>
                                            <div className="h-1 bg-slate-100 dark:bg-slate-800 w-full rounded-full overflow-hidden">
                                                <div className="h-full bg-slate-300 w-[60%]"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            {/* Expertise & Intelligence Demo Section */}
                            <section id="expertise" className="py-40 bg-slate-50 dark:bg-slate-900/20">
                                <div className="max-w-7xl mx-auto px-8">
                                    <div className="text-center mb-32">
                                        <span className="text-[10px] tracking-[0.5em] text-slate-400 uppercase mb-8 block">Domain Expertise</span>
                                        <h2 className="text-5xl font-normal">최첨단 보안 기술력</h2>
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-12">
                                        {/* Service 1 */}
                                        <div className="p-12 glass group hover:bg-slate-900 dark:hover:bg-indigo-600 transition-all duration-500">
                                            <div className="text-3xl mb-10 group-hover:text-white transition-colors">01</div>
                                            <h4 className="text-xl mb-6 group-hover:text-white transition-colors">AI 취약점 탐지</h4>
                                            <p className="text-slate-400 text-sm leading-relaxed mb-10 group-hover:text-slate-200 transition-colors">
                                                지능형 정적/동적 분석을 통해 알려지지 않은 위협을 선제적으로 식별합니다.
                                            </p>
                                            <div className="h-32">
                                                <canvas id="chart-vuln" width="200" height="100"></canvas>
                                            </div>
                                        </div>
                                        {/* Service 2 */}
                                        <div className="p-12 glass group hover:bg-slate-900 dark:hover:bg-indigo-600 transition-all duration-500">
                                            <div className="text-3xl mb-10 group-hover:text-white transition-colors">02</div>
                                            <h4 className="text-xl mb-6 group-hover:text-white transition-colors">상시 보안 컨설팅</h4>
                                            <p className="text-slate-400 text-sm leading-relaxed mb-10 group-hover:text-slate-200 transition-colors">
                                                기업별 맞춤형 보안 로드맵 수립 및 인증 대응 가이드를 제공합니다.
                                            </p>
                                            <div className="flex items-center gap-2 group-hover:text-white transition-colors">
                                                <span className="text-[10px] tracking-widest uppercase">Compliance Level</span>
                                                <div className="flex-grow h-[1px] bg-slate-200 dark:bg-white/10 group-hover:bg-white/30"></div>
                                                <span className="text-xs">A+</span>
                                            </div>
                                        </div>
                                        {/* Service 3 */}
                                        <div className="p-12 glass group hover:bg-slate-900 dark:hover:bg-indigo-600 transition-all duration-500">
                                            <div className="text-3xl mb-10 group-hover:text-white transition-colors">03</div>
                                            <h4 className="text-xl mb-6 group-hover:text-white transition-colors">위협 인텔리전스</h4>
                                            <p className="text-slate-400 text-sm leading-relaxed mb-10 group-hover:text-slate-200 transition-colors">
                                                글로벌 보안 커뮤니티와 연계된 실시간 위협 정보 데이터베이스를 운용합니다.
                                            </p>
                                            <div className="space-y-3">
                                                <div className="flex justify-between text-[9px] group-hover:text-white transition-colors">
                                                    <span>SQL INJECTION</span>
                                                    <span>DETECTED</span>
                                                </div>
                                                <div className="flex justify-between text-[9px] group-hover:text-white transition-colors opacity-50">
                                                    <span>XSS ATTACK</span>
                                                    <span>BLOCKED</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            {/* Contact Section */}
                            <section id="contact" className="py-40 bg-white dark:bg-slate-950">
                                <div className="max-w-3xl mx-auto px-8 text-center">
                                    <span className="text-[10px] tracking-[0.5em] text-indigo-500 uppercase mb-8 block">Start a Project</span>
                                    <h2 className="text-4xl mb-20 font-normal">전문가 상담 및 문의</h2>
                                    <form onSubmit={handleInquirySubmit} className="space-y-12 text-left">
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-12">
                                            <div className="relative">
                                                <input type="text" value={formData.name} onChange={e => setFormData({ ...formData, name: e.target.value })} className="peer bg-transparent border-b border-black/10 dark:border-white/10 py-3 outline-none w-full focus:border-indigo-500 transition-all" required />
                                                <label className="absolute left-0 top-3 text-slate-400 pointer-events-none transition-all peer-focus:-top-4 peer-focus:text-[10px] peer-focus:text-indigo-500">성함 / Company</label>
                                            </div>
                                            <div className="relative">
                                                <input type="email" value={formData.email} onChange={e => setFormData({ ...formData, email: e.target.value })} className="peer bg-transparent border-b border-black/10 dark:border-white/10 py-3 outline-none w-full focus:border-indigo-500 transition-all" required />
                                                <label className="absolute left-0 top-3 text-slate-400 pointer-events-none transition-all peer-focus:-top-4 peer-focus:text-[10px] peer-focus:text-indigo-500">이메일 주소</label>
                                            </div>
                                        </div>
                                        <div className="relative">
                                            <textarea value={formData.message} onChange={e => setFormData({ ...formData, message: e.target.value })} rows="4" className="peer bg-transparent border-b border-black/10 dark:border-white/10 py-3 outline-none w-full resize-none focus:border-indigo-500 transition-all" required></textarea>
                                            <label className="absolute left-0 top-3 text-slate-400 pointer-events-none transition-all peer-focus:-top-4 peer-focus:text-[10px] peer-focus:text-indigo-500">상세 문의 내용</label>
                                        </div>
                                        <button className="w-full py-6 bg-slate-900 text-white dark:bg-indigo-600 text-[11px] tracking-[0.4em] uppercase hover:scale-[1.01] transition-all">Submit Secure Inquiry</button>
                                    </form>
                                </div>
                            </section>
                        </main>
                    )}

                    {view === 'setup' && (
                        <main className="flex-grow pt-40 flex flex-col items-center">
                            <div className="max-w-md w-full glass p-10 text-center space-y-8">
                                <h3 className="text-2xl">OTP 보안 설정</h3>
                                <p className="text-sm text-slate-400">스마트폰의 Google Authenticator 앱으로 아래 QR코드를 스캔하십시오.</p>
                                <img src={qrCode} alt="OTP QR" className="mx-auto border-8 border-white" />
                                <div className="space-y-4">
                                    <p className="text-xs text-slate-500">스캔 후 생성된 6자리 코드를 입력하여 설정을 완료하십시오.</p>
                                    <input type="text" maxLength="6" id="setupToken" className="w-full bg-slate-100 dark:bg-slate-800 p-4 text-center tracking-[1em] text-xl" />
                                    <button onClick={() => confirmSetup(document.getElementById('setupToken').value)} className="w-full py-4 bg-indigo-600 text-white text-xs tracking-widest uppercase">설정 완료</button>
                                </div>
                            </div>
                        </main>
                    )}

                    {view === 'admin' && isAdminAuth && (
                        <main className="flex-grow pt-40 px-8">
                            <div className="max-w-6xl mx-auto">
                                <div className="flex justify-between items-end mb-16">
                                    <h2 className="text-4xl font-normal">Internal Intelligence Pipeline</h2>
                                    <span className="text-xs text-indigo-400 tracking-widest">{inquiries.length} SECURE RECORDS</span>
                                </div>
                                <div className="glass overflow-hidden border border-black/5 dark:border-white/5">
                                    <table className="w-full text-left text-xs">
                                        <thead className="bg-slate-50 dark:bg-slate-800 text-slate-400 uppercase tracking-widest">
                                            <tr>
                                                <th className="px-8 py-6">Status</th>
                                                <th className="px-8 py-6">Client Identity</th>
                                                <th className="px-8 py-6">Intelligence Content</th>
                                                <th className="px-8 py-6 text-right">Received</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-black/5 dark:divide-white/5">
                                            {inquiries.map(item => (
                                                <tr key={item.id} className="hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-all">
                                                    <td className="px-8 py-8">
                                                        <button onClick={() => updateInquiryStatus(item.id, item.status)} className={`px-3 py-1 border text-[9px] ${item.status === 'completed' ? 'border-indigo-500 text-indigo-400' : 'border-slate-300 text-slate-400'}`}>
                                                            {item.status?.toUpperCase()}
                                                        </button>
                                                    </td>
                                                    <td className="px-8 py-8">
                                                        <div className="text-sm dark:text-white mb-1">{item.name}</div>
                                                        <div className="text-slate-400">{item.email}</div>
                                                    </td>
                                                    <td className="px-8 py-8 text-slate-400 max-w-sm">{item.message}</td>
                                                    <td className="px-8 py-8 text-right text-slate-300">{new Date(item.createdAt).toLocaleDateString()}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                    {inquiries.length === 0 && <div className="py-20 text-center text-slate-400">데이터 접수 내역이 없습니다.</div>}
                                </div>
                            </div>
                        </main>
                    )}

                    <footer className="py-20 border-t border-black/5 dark:border-white/5 opacity-50 mt-20">
                        <div className="max-w-7xl mx-auto px-8 flex justify-between items-center text-[9px] tracking-[0.3em] uppercase">
                            <div className="space-y-2">
                                <div>Admin: 보안 전문가</div>
                                <a href="https://www.youtube.com/@SecurityReport-K" target="_blank" rel="noopener noreferrer" className="block hover:text-red-500 transition-colors">YouTube: @SecurityReport-K</a>
                            </div>
                            <div>© 2026 AI SECULAB (Internal Mode)</div>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>